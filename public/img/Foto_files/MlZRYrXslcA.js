if (self.CavalryLogger) { CavalryLogger.start_js(["KB8B8"]); }

__d("DocumentSnapShot",["ErrorUtils"],(function(a,b,c,d,e,f,g){__p&&__p();var h;"nextElementSibling"in document.documentElement?h=function(a){return a.nextElementSibling}:h=function(a){a=a.nextSibling;while(a&&a.nodeType!==1)a=a.nextSibling;return a};function i(b,c,d){__p&&__p();b=b;var e=0,f=1,i=f,j=0,k,l=[];while(!(j===0&&i===e))switch(i){case f:k=!1;k=d?g.applyWithGuard(d,a,[b],null,"traverse-filter"):!0;l.push([j,b]);if(k)while(l.length>0)g.applyWithGuard(c,a,l.shift(),null,"traverse-walker");b.children.length>0?(b=b.children[0],j++):i=e;break;case e:k||l.pop();h(b)?(b=h(b),i=f):(b=b.parentNode,j--);break}}function b(a){var b=[],c=function(a,c){b.push(new Array(a+1).join("  ")+c.tagName.toLowerCase()+(c.id?' id="'+c.id+'"':"")+(c.className?' class="'+c.className+'"':"")+(c.hasAttribute("data-sigil")?' sigil="'+c.getAttribute("data-sigil")+'"':""))},d=function(a){return!!(a.id||a.className||a.hasAttribute("data-sigil"))};i(a||document.documentElement,c,d);return b.join("\n")}e.exports.capture=b}),null);
__d("SnapShotHook",["DocumentSnapShot"],(function(a,b,c,d,e,f,g){function a(a,b){b&&(a.snapshot=g.capture(b))}e.exports=a}),null);
__d("BanzaiOld",["BanzaiAdapter","NavigationMetrics","BanzaiConsts","BanzaiLazyQueue","BanzaiStreamPayloads","CurrentUser","ErrorUtils","ExecutionEnvironment","FBJSON","FBLogger","SetIdleTimeoutAcrossTransitions","TimeSlice","Visibility","WebStorage","emptyFunction","isInIframe","lowerFacebookDomain","onAfterDisplay","pageID","performanceAbsoluteNow","WebStorageMutex"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,aa,x,y){__p&&__p();var z=6e4,A=1e3,B=g,C=v(),D="bz:",E="ods:banzai",ba="send_via_beacon_failure",F=0,G=1,H=2,I=null,J,K,L=[],M=null,N=[];function O(a){return a[2]>=y()-(B.config.EXPIRY||$.EXPIRY)}function P(a,b){var c=a.__meta;c.status=F;a[3]=(a[3]||0)+1;c.retry===!1&&b>=400&&b<600&&L.push(a)}function Q(a,b,c,d){a=[a,b,c,0];a.__meta={retry:d===!0,pageID:x,userID:l.getID(),status:F};return a}function ca(){__p&&__p();var a=[];N.forEach(function(b){var c=b.cb();c.forEach(function(c){var d=b.route;if(d!=null||d!=""){d=Q(d,c,y());d.__meta.onSuccess=b.onSuccess;d.__meta.onFailure=b.onFailure;a.push(d)}})});N=[];var b=[],c=[];U(b,c,!0,a);if(b.length>0){b[0].send_method="beacon";b.map(B.prepWadForTransit);b=new Blob([B.addRequestAuthData(B.prepForTransit(b))],{type:"application/x-www-form-urlencoded"});b=navigator.sendBeacon($.adapter.endpoint,b);b?c.forEach(function(a){a=a.__meta;a!=null&&a.onSuccess!=null&&a.onSuccess()}):c.forEach(function(a){a=a.__meta;a!=null&&a.onFailure!=null&&a.onFailure()})}}function R(a){__p&&__p();var b=y()+a;if(K==null||b<K){K=b;q.clear(J);b=function(){J=q.start(da,a)};b();return!0}return!1}var da=r.guard(function(){S(null,null)},"Banzai.send",{propagationType:r.PropagationType.ORPHAN});function S(a,b){__p&&__p();K=null;R($.BASIC.delay);if(!B.readyToSend()){b&&b();return}($.isEnabled("flush_storage_periodically")||$.isEnabled("error_impact_test"))&&(Z(),m.applyWithGuard(V.flush,V));B.inform($.SEND);var c=[],d=[];L=U(c,d,!0,L);if(c.length<=0){B.inform($.OK);a&&a();return}c[0].trigger=M;M=null;c[0].send_method="ajax";c.map(B.prepWadForTransit);B.send(c,function(){d.forEach(function(a){a=a.__meta;a.status=H;a.callback!=null&&a.callback()}),a&&a()},function(a){d.forEach(function(b){P(b,a)}),b&&b()})}function T(){__p&&__p();if(!(navigator&&navigator.sendBeacon&&B.isOkToSendViaBeacon()))return!1;var a=[],b=[];L=U(a,b,!1,L);if(a.length<=0)return!1;a[0].send_method="beacon";a.map(B.prepWadForTransit);a=new Blob([B.addRequestAuthData(B.prepForTransit(a))],{type:"application/x-www-form-urlencoded"});a=navigator.sendBeacon($.adapter.endpoint,a);if(!a){b.forEach(function(a){L.push(a)});L.push(Q(E,(a={},a[ba]=[1],a),y()));return!1}return!0}function U(a,b,c,d){__p&&__p();var e={};return d.filter(function(d){__p&&__p();var f=d.__meta;if(f.status>=H||!O(d))return!1;if(f.status>=G)return!0;var g=f.compress!=null?f.compress:!0,h=f.pageID+f.userID+(g?"compress":""),i=e[h];i||(i={user:f.userID,page_id:f.pageID,posts:[],snappy:g},e[h]=i,a.push(i));f.status=G;i.posts.push(d);b.push(d);return c&&!!f.retry})}var V,W,X=!1;function Y(){X||(X=!0,W=t.getLocalStorage());return W}function Z(){__p&&__p();V||(!C?V={store:function(){var a=Y();if(a==null||L.length<=0)return;var b=L.map(function(a){return[a[0],a[1],a[2],a[3]||0,a.__meta]});L=[];t.setItemGuarded(a,D+x+"."+y(),o.stringify(b))},restore:function(){__p&&__p();var a=Y();if(!a)return;var c=b("WebStorageMutex");new c("banzai").lock(function(b){__p&&__p();var c=[];for(var d=0;d<a.length;d++){var e=a.key(d);if(e==null||e==="")continue;e.indexOf(D)===0&&e.indexOf("bz:__")!==0&&c.push(e)}c.forEach(function(b){__p&&__p();var c=a.getItem(b);a.removeItem(b);if(c==null)return;b=o.parse(c);b.forEach(function(a){if(!a)return;var b=a.__meta=a.pop(),c=O(a);if(!c)return;c=l.getID();(b.userID===c||c==="0")&&(b.status=F,L.push(a))})});b.unlock()})},flush:function(){var a=Y();if(a){I===null&&(I=parseInt(a.getItem(i.LAST_STORAGE_FLUSH),10));var b=I&&y()-I>=i.STORAGE_FLUSH_INTERVAL;b&&$._restore(!1);(b||!I)&&(I=y(),t.setItemGuarded(a,i.LAST_STORAGE_FLUSH,I.toString()))}}}:V={store:u,restore:u,flush:u})}var $={adapter:B,SEND:"Banzai:SEND",OK:"Banzai:OK",ERROR:"Banzai:ERROR",SHUTDOWN:"Banzai:SHUTDOWN",VITAL_WAIT:A,BASIC_WAIT:z,EXPIRY:30*6e4,VITAL:{delay:g.config.MIN_WAIT||A},BASIC:{delay:g.config.MAX_WAIT||z},isEnabled:function(a){return B.config.gks&&B.config.gks[a]},post:function(b,c,d){__p&&__p();var e;(b==null||b==="")&&p("banzai").mustfix("Banzai.post called without specifying a route");var f=d==null?void 0:d.retry;if(B.config.disabled)return;if(!n.canUseDOM)return;var g=B.config.blacklist;if(g&&(g.indexOf&&(typeof g.indexOf==="function"&&g.indexOf(b)!=-1)))return;if(C&&w.isValidDocumentDomain()){var h;try{h=a.top.require("Banzai")}catch(a){h=null}if(h){h.post.apply(h,arguments);return}}var i=Q(b,c,y(),f),k=i.__meta;d!=null&&d.callback!=null&&(k.callback=d.callback);d!=null&&d.compress!=null&&(k.compress=d.compress);if(d!=null&&d.signal!=null){k.status=G;var m=[{user:l.getID(),page_id:x,posts:[i],trigger:b}];B.send(m,function(){k.status=H,k.callback&&k.callback()},function(a){P(i,a)},!0);if(f==null)return}L.push(i);var o=(e=d==null?void 0:d.delay)!=null?e:z;(R(o)||M==null||M==="")&&(M=b);var q=j.flushQueue();q.forEach(function(a){return $.post.apply($,a)})},registerToSendWithBeacon:function(a,b,c,d){if(!(navigator&&navigator.sendBeacon&&B.isOkToSendViaBeacon()))return!1;if(!a){p("banzai").mustfix("Banzai.registerToSendWithBeacon called without specifying a route");return!1}N.push({cb:b,route:a,onSuccess:c,onFailure:d});return!0},flush:function(a,b){q.clear(J),S(a,b)},subscribe:B.subscribe,canUseNavigatorBeacon:function(){return navigator&&navigator.sendBeacon?B.isOkToSendViaBeacon():!1},_schedule:R,_store:function(a){Z(),m.applyWithGuard(V.store,V)},_restore:function(a){Z(),m.applyWithGuard(V.restore,V),R(B.config.RESTORE_WAIT||A)},_testState:function(){return{postBuffer:L,triggerRoute:M}},_unload:function(){k.unload($.post),navigator&&navigator.sendBeacon&&B.isOkToSendViaBeacon()&&ca(),B.cleanup(),B.inform($.SHUTDOWN),L.length>0&&((!B.useBeacon||!T())&&(Z(),m.applyWithGuard(V.store,V)))},_initialize:function(){n.canUseDOM&&(B.useBeacon&&s.isSupported()?(s.addListener(s.HIDDEN,function(){L.length>0&&(T()||(Z(),m.applyWithGuard(V.store,V)))}),($.isEnabled("enable_client_logging_clear_on_visible")||$.isEnabled("error_impact_test"))&&s.addListener(s.VISIBLE,function(){T()||m.applyWithGuard(V.restore,V)})):B.setHooks($),B.setUnloadHook($),h.addListener(h.Events.NAVIGATION_DONE,function(a,b){if(b.pageType!=="normal")return;$._restore();h.removeCurrentListener()}))}};$._initialize();e.exports=$}),null);