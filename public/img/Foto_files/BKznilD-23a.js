if (self.CavalryLogger) { CavalryLogger.start_js(["fHANF"]); }

__d("Keyframes",["Promise","Bootloader","NavigationMetrics","XHRRequest","emptyFunction","once","promiseDone"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";__p&&__p();var n="::",o="tti";i.addRetroactiveListener(i.Events.EVENT_OCCURRED,function(a,b){a=b.event;o=a});function p(){return new g(function(a){h.loadModules(["KeyframesRenderer"],function(b){return a(b)},"Keyframes")})}function q(){return new g(function(a){h.loadModules(["FBKeyframesLoggedSession"],function(b){return a(b)},"Keyframes")})}function r(){return new g(function(a){h.loadModules(["KeyframesAssetDecoder"],function(b){return a(b)},"Keyframes")})}function s(){return g.all([q(),r(),p()]).then(k)}function t(a){return!a||typeof a!=="string"?g.reject("Request: invalid uri "+a):new g(function(b,c){new j(a).setMethod("GET").setResponseType("arraybuffer").setErrorHandler(function(a){return c(a)}).setAbortHandler(function(a){return c(a)}).setResponseHandler(function(a){return b(a)}).send()})}function u(a){this.$3=function(){var a=u.timestamp();m(this.$1,function(b){return b.error(a)})}.bind(this),this.$1=q().then(function(b){return new b(a)}),this.$2=this.$1.then(function(a){return a.getPerformanceLogIfEnabled()})}u.timestamp=function(){return{value:Date.now(),phase:o}};u.prototype.scheduleDecode=function(a,b){__p&&__p();var c=a.then(function(){return u.timestamp()}),d=a.then(function(){return b}).then(function(){return u.timestamp()}),e=b.then(function(a){return a&&a.pluginsLoader&&a.pluginsLoader.getPluginTable instanceof Function?a.pluginsLoader.getPluginTable():[]});a=g.all([this.$1,c]).then(function(a){var b=a[0];a=a[1];b=b.startDecode(a);return g.all([b,d,e])});m(a,function(a){var b=a[0],c=a[1];a=a[2];return b(c,a)},this.$3)};u.prototype.markAsPackage=function(){m(this.$1,function(a){return a.markAsPackage()})};u.prototype.maybeGetPerformanceLog=function(){return this.$2};function v(a,b){__p&&__p();this.$2=!1;a=g.all([t(a),r()]);this.$1=a.then(function(a){var b=a[0];a=a[1];return a.getDocumentByteSlicesFromPackage(b).then(function(a){return a.map(function(a,b){return l(function(b){return new w(a,b)})})})});b=new u({projectName:b.projectName,assetName:b.packageName});b.markAsPackage();b.scheduleDecode(a,this.$1);m(this.$1,function(){return this.$2=!0}.bind(this),function(){return this.$2=!0}.bind(this))}v.getSliceSession=function(a,b){return new u({projectName:a.projectName,assetName:a.packageName+n+b})};v.prototype.isDone=function(){return this.$2};v.prototype.getAllAssets=function(a){return this.$1.then(function(b){return g.all(b.map(function(b,c){return b(v.getSliceSession(a,c)).getAsset()}))})};v.prototype.getRendererAtIndex=function(a,b){return this.$1.then(function(c){var d=v.getSliceSession(b,a);return c[a]?c[a](d).getRenderer(d):g.reject("Out of bounds index in package: "+a)})};function w(a,b){__p&&__p();this.$1=!1;a=g.all([typeof a==="string"?t(a):a,r()]);this.$2=a.then(function(a){var b=a[0];a=a[1];return a.fromDocumentBytes(b)});b.scheduleDecode(a,this.$2);m(this.$2,function(){return this.$1=!0}.bind(this),function(){return this.$1=!0}.bind(this))}w.prototype.isDone=function(){return this.$1};w.prototype.getAsset=function(){return this.$2};w.prototype.getRenderer=function(b){var a=p();return g.all([this.$2,a,b.maybeGetPerformanceLog()]).then(function(a){var b=a[0],c=a[1];a=a[2];return new c(b,a)})};var x={},y={};a={requestRenderer:function(a,b){b=new u(b);x[a]||(x[a]=new w(a,b));return x[a].getRenderer(b)},preload:function(a,b){if(!x[a]){b=new u(b);x[a]=new w(a,b)}b=s();a=x[a].getAsset();return g.all([b,a]).then(k)},requestRendererFromBytes:function(a,b){b=new u(b);return new w(a,b).getRenderer(b)},requestRendererFromPackage:function(a,b,c){y[a]||(y[a]=new v(a,c));return y[a].getRendererAtIndex(b,c)},preloadPackage:function(a,b){y[a]||(y[a]=new v(a,b));var c=s();a=y[a].getAllAssets(b);return g.all([c,a]).then(k)},hasLoaded:function(a){return!!(x[a]&&x[a].isDone()||y[a]&&y[a].isDone())},clearCache:function(){x={},y={}}};e.exports=a}),null);