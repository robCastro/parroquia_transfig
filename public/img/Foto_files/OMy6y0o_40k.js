if (self.CavalryLogger) { CavalryLogger.start_js(["JthKB"]); }

__d("MFullScreen",[],(function(a,b,c,d,e,f){__p&&__p();a={debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d);d=setTimeout(g,b);h&&a.apply(e,f)}},isSupported:function(){var a=document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.fullscreenEnabled,b=document.webkitCancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.cancelFullScreen||document.exitFullScreen;return a&&b},isFullScreen:function(){return document.webkitIsFullScreen||document.fullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement},enableFullScreen:function(a){a.webkitRequestFullScreen?a.webkitRequestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.requestFullScreen?a.requestFullScreen():a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()},disableFullScreen:function(){document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullScreen&&document.exitFullScreen()},listenForFullScreenEvent:function(a,b){var c=this.debounce(b,500),d=["webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange","fullscreenchange"];d.forEach(function(b){return a.addEventListener(b,c)});return{remove:function(){d.forEach(function(b){return a.removeEventListener(b,c)})}}},removeFullScreenEventListeners:function(a,b){var c=this.debounce(b,500);a.removeEventListener("webkitfullscreenchange",b);a.removeEventListener("mozfullscreenchange",b);a.removeEventListener("MSFullscreenChange",b);a.removeEventListener("fullscreenchange",c)}};e.exports=a}),null);
__d("mergeHelpers",["FbtResultBase","invariant"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=36,j=function(a){return typeof a!=="object"||a instanceof Date||a===null||a instanceof g},k={MAX_MERGE_DEPTH:i,isTerminal:j,normalizeMergeArg:function(a){return a==null?{}:a},checkMergeArrayArgs:function(a,b){Array.isArray(a)&&Array.isArray(b)||h(0,3714,a,b)},checkMergeObjectArgs:function(a,b){k.checkMergeObjectArg(a),k.checkMergeObjectArg(b)},checkMergeObjectArg:function(a){!j(a)&&!Array.isArray(a)||h(0,3715,a)},checkMergeIntoObjectArg:function(a){(!j(a)||typeof a==="function")&&!Array.isArray(a)||h(0,3716,a)},checkMergeLevel:function(a){a<i||h(0,3717)},checkArrayStrategy:function(a){a==null||a in k.ArrayStrategies||h(0,3718)},ArrayStrategies:{Clobber:"Clobber",Concat:"Concat",IndexByIndex:"IndexByIndex"}};e.exports=k}),null);
__d("mergeDeepInto",["invariant","mergeHelpers"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=h.ArrayStrategies,j=h.checkArrayStrategy,k=h.checkMergeArrayArgs,l=h.checkMergeLevel,m=h.checkMergeObjectArgs,n=h.isTerminal,o=h.normalizeMergeArg,p=function(a,b,c,d){m(a,b);l(d);var e=b?Object.keys(b):[];for(var f=0;f<e.length;f++){var g=e[f];r(a,b,g,c,d)}},q=function(a,b,c,d){k(a,b);l(d);if(c===i.Concat)a.push.apply(a,b);else{var e=Math.max(a.length,b.length);for(var f=0;f<e;f++)r(a,b,f,c,d)}},r=function(a,b,c,d,e){var f=b[c];b=Object.prototype.hasOwnProperty.call(b,c);var h=b&&n(f),j=b&&Array.isArray(f),k=b&&!j&&!j,l=a[c],m=Object.prototype.hasOwnProperty.call(a,c),o=m&&n(l),r=m&&Array.isArray(l),s=m&&!r&&!r;o?h?a[c]=f:j?(a[c]=[],q(a[c],f,d,e+1)):k?(a[c]={},p(a[c],f,d,e+1)):b||(a[c]=l):r?h?a[c]=f:j?(i[d]||g(0,5117),d===i.Clobber&&(l.length=0),q(l,f,d,e+1)):k?(a[c]={},p(a[c],f,d,e+1)):!b:s?h?a[c]=f:j?(a[c]=[],q(a[c],f,d,e+1)):k?p(l,f,d,e+1):!b:m||(h?a[c]=f:j?(a[c]=[],q(a[c],f,d,e+1)):k?(a[c]={},p(a[c],f,d,e+1)):!b)};a=function(a,b,c){b=o(b);j(c);p(a,b,c,0)};e.exports=a}),null);
__d("AsyncStorage",["Deferred","mergeDeepInto","mergeHelpers"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=i.ArrayStrategies,k=window.indexedDB,l=1,m="data",n=!1,o;b=Date.now();var p=new g();function a(){__p&&__p();var a=k.open("AsyncStorage",l);a.onerror=function(a){a=new Error("Failed to open AsyncStorage IndexedDB instance.");p.reject(a)};a.onsuccess=function(a){n&&!1,o=a.target.result,p.resolve({db:o}),o.onerror=function(a){a=new Error("AsyncStorage error: "+a.target.error.message);p.reject(a)}};a.onupgradeneeded=function(a){a=a.currentTarget.result;if(a.objectStoreNames&&a.objectStoreNames.contains(m))return;a.createObjectStore(m,{keyPath:"key"})}}k&&a();function q(a,b){if(o)try{a()}catch(a){b&&b(a)}else p.getPromise().then(function(){n&&!1,q(a,b)},function(a){b&&b(a)})}c={setItem:function(a,b,c){this.multiSet([[a,b]],function(a){c(a&&a[0]||null)})},getItem:function(a,b){this.multiGet([a],function(a,c){c=c!==void 0&&c[0]!==void 0&&c[0][1]!==void 0?c[0][1]:null;b(a&&a[0]||null,c)})},removeItem:function(a,b){this.multiRemove([a],function(a){b(a&&a[0]||null)})},multiGet:function(a,b){var c=[];this._multiOp(a,"readonly",function(a){return b(a,c)},function(a){return a},function(a,b,d){b&&a===b.key?(n&&!1,c.push([a,b.value.value])):c.push([a,null])})},multiSet:function(a,b){this._multiOp(a,"readwrite",b,function(a){return a[0]},function(a,b,c){if(b&&a[0]===b.key){var d=b.value;d.value=a[1];n&&!1;b.update(d)}else c.push(a)})},multiMerge:function(a,b){__p&&__p();this._multiOp(a,"readwrite",b,function(a){return a[0]},function(a,b,c){if(b&&a[0]===b.key){var d=b.value,e=JSON.parse(d.value);h(e,JSON.parse(a[1]),j.Clobber);n&&!1;d.value=JSON.stringify(e);b.update(d)}else n&&!1,c.push(a)})},multiRemove:function(a,b){this._multiOp(a,"readwrite",b,function(a){return a},function(a,b,c){b&&a===b.key&&(n&&!1,b["delete"]())})},getAllKeys:function(a){__p&&__p();q(function(){__p&&__p();var b=o.transaction([m],"readonly");b=b.objectStore(m).openCursor();var c=[];b.onsuccess=function(b){b=b.target.result;if(!b){a(null,c);return}c.push(b.key);b["continue"]()}},function(){return a(null,[])})},clear:function(a){__p&&__p();q(function(){__p&&__p();var b=o.transaction([m],"readwrite");b=b.objectStore(m).openCursor();b.onsuccess=function(b){b=b.target.result;if(!b){a(null);return}b["delete"]();b["continue"]()}},function(){return a(null)})},_multiOp:function(a,b,c,d,e){__p&&__p();q(function(){__p&&__p();var f=!1,g=a.slice().sort(function(a,b){a=d(a);b=d(b);if(a===b){var e=new Error("AsyncStorage._multiOp cannot process duplicate keys.");c&&c([e]);f=!0;return 0}return a<b?-1:1});if(f)return;var h=o.transaction([m],b),i=h.objectStore(m).openCursor(),j=[],k=0;i.onsuccess=function(a){__p&&__p();a=a.target.result;if(!a){while(k<g.length)e(g[k],a,j),k++;l();return}var b=a.key;n&&!1;while(d(g[k])<=b){n&&!1;e(g[k],a,j);k++;if(k===g.length){l();return}}b=d(g[k]);a["continue"](b)};function l(){var a=h.objectStore(m);j.forEach(function(b){n&&!1,a.add({key:b[0],value:b[1]})})}h.oncomplete=function(){c&&c(null)};h.onerror=function(a){a=new Error("IndexedDB error: "+a.target.error.message);c&&c([a])};n&&!1},function(a){c&&c([a])})}};e.exports=c}),null);
__d("MVideoCacheConfig",["CurrentUser","MVideoDownloadConfig","md5","WebStorage"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=null,k={CACHE_PREFIX:"vc",PREFIX_SEPARATOR:"_",CONFIG_PREFIX:"config",KEYS:{lastCleanUp:"lastCleanUp"},isSupported:function(){try{j||(j=b("WebStorage"));return j.getLocalStorage()}catch(a){j=null;return!1}},currentAccountHash:function(){var a=""+g.getAccountID();return i(a)},getUserPrefix:function(){return k.CACHE_PREFIX+k.PREFIX_SEPARATOR+k.currentAccountHash()+k.PREFIX_SEPARATOR},getCacheConfigKey:function(){return k.CACHE_PREFIX+k.PREFIX_SEPARATOR+k.CONFIG_PREFIX+k.PREFIX_SEPARATOR+k.currentAccountHash()},initCacheConfig:function(){var a={},b=Date.now()-2*h.cache_sync_interval_ms;a[k.KEYS.lastCleanUp]=b;a=JSON.stringify(a);b=k.getCacheConfigKey();j.getLocalStorage().setItem(b,a);return a},getCacheConfig:function(){var a=k.getCacheConfigKey();a=j.getLocalStorage().getItem(a);try{JSON.parse(a)}catch(b){a=null}a===null&&(a=k.initCacheConfig());a=JSON.parse(a);return a},getItemFromConfig:function(a){var b=k.getCacheConfig();return b[a]},setItemFromConfig:function(a,b){var c=k.getCacheConfig();c[a]=b;c=JSON.stringify(c);a=k.getCacheConfigKey();j.getLocalStorage().setItem(a,c)}};e.exports=k}),null);
__d("XHRRequestRetrier",["setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a){"use strict";this.$1=a,this.$2=!1,this.$3=0,this.$4=0,this.$5=0,this.$6=1e3,this.$7=2,this.$8=.5,this.$9=a.getErrorHandler(),a.setErrorHandler(this.$11.bind(this)),this.$10=a.getAbortHandler(),a.setAbortHandler(this.$12.bind(this))}a.prototype.setMaxAttempts=function(a){"use strict";this.$5=a;return this};a.prototype.setBaseRetryDelayMs=function(a){"use strict";this.$6=a;return this};a.prototype.setRetryBackoffFactor=function(a){"use strict";this.$7=a;return this};a.prototype.setRetryFuzzFactor=function(a){"use strict";this.$8=a;return this};a.prototype.send=function(){"use strict";if(this.$2)return;if(this.$1.getTimeout())throw new Error("Not supported.");this.$3++;this.$4||(this.$4=this.$6);this.$1.send()};a.prototype.$11=function(){"use strict";this.$3<this.$5?this.$13():this.$9&&this.$9.apply(this,arguments)};a.prototype.$12=function(){"use strict";this.$2=!0,this.$10&&this.$10.apply(this,arguments)};a.prototype.$13=function(){"use strict";var a=this.send.bind(this),b=Math.random()*2-1;b=b*this.$8;b=this.$4*(1+b);g(a,b);this.$4*=this.$7};e.exports=a}),null);
__d("URIDownloader",["URI","XHRRequest","XHRRequestRetrier","invariant"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=2e5,l=15,m=2e3,n=1.5;function a(a,b){"use strict";this.$1=new g(a),this.$2=b,this.$3=0,this.$4=0,this.$5=[]}a.prototype.setResponseHandler=function(a){"use strict";this.$10&&j(0,3234);this.$9=a;return this};a.prototype.setChunkedResponseHandler=function(a){"use strict";this.$9&&j(0,3235);this.$10=a;return this};a.prototype.setErrorHandler=function(a){"use strict";this.$11=a;return this};a.prototype.setAbortHandler=function(a){"use strict";this.$12=a;return this};a.prototype.setProgressHandler=function(a){"use strict";this.$13=a;return this};a.prototype.$14=function(a){"use strict";if(this.$8)return;this.$13&&this.$13({total:this.$2,loaded:this.$4+(a?a:0)})};a.prototype.$15=function(){"use strict";if(this.$8)return;if(this.$9){var a=null;this.$5&&(a=new Blob(this.$5));this.$9(a)}this.$10&&this.$10(this.$5)};a.prototype.$16=function(a){"use strict";if(this.$8)return;this.$17(a)?this.$4<this.$2?(this.$14(),this.$18()):this.$15():this.$19()};a.prototype.$19=function(){"use strict";if(this.$8)return;this.$11&&this.$11()};a.prototype.$20=function(){"use strict";if(this.$8)return;this.$12&&this.$12()};a.prototype.$21=function(){"use strict";var a=Math.min(this.$4+k,this.$2);this.$3=a-this.$4};a.prototype.$17=function(a){"use strict";if(this.$8)return!1;if(this.$3!==a.size)return!1;this.$5.push(a);this.$4+=this.$3;this.$3=0;return!0};a.prototype.$18=function(){"use strict";__p&&__p();if(this.$8)return;var a=new h(this.$1).setMethod("GET").setResponseType("blob").setResponseHandler(this.$16.bind(this)).setErrorHandler(this.$19.bind(this)).setAbortHandler(this.$20.bind(this)).setDownloadProgressHandler(function(a){a.loadedBytes&&this.$14(a.loadedBytes)}.bind(this));this.$21();a.setRequestHeader("Range","bytes="+this.$4+"-"+(this.$4+this.$3-1));this.$7=a;a=new i(a).setMaxAttempts(l).setBaseRetryDelayMs(m).setRetryBackoffFactor(n);this.$6=a;try{a.send()}catch(a){this.$19()}};a.prototype.sendRequest=function(){"use strict";this.$4=0,this.$18()};a.prototype.abort=function(){"use strict";this.$8=!0,this.$7&&this.$7.abort?this.$7.abort():this.$12&&this.$12(),this.$22()};a.prototype.$22=function(){"use strict";this.$7=null,this.$5=null,this.$12=null,this.$11=null,this.$9=null,this.$13=null};e.exports=a}),null);
__d("VideoDownloadDeleteReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CACHE_SYNC:"cache_sync",CONSISTENCY_CHECK:"consistency_check",USER_INITIATED:"user_initiated",CHUNKED_PLAYBACK_NOT_SUPPORTED:"chunked_playback_not_supported"})}),null);
__d("XVideoDownloadEventController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video_download_event/",{video_id:{type:"Int",required:!0},viewer_id:{type:"Int",required:!0},app_id:{type:"Int",required:!0},event:{type:"Enum",required:!0,enumType:1}})}),null);
__d("VideoDownloadEventHandler",["CurrentUser","DataAttributeUtils","MRequest","XVideoDownloadEventController"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=412378670482;function a(a,b,c){"use strict";this.$1=a,this.$2=b,this.$3=c}a.prototype.sendServerDownloadEvent=function(){"use strict";var a=j.getURIBuilder().setInt("video_id",this.$1).setInt("viewer_id",g.getAccountID()).setInt("app_id",k).setEnum("event",this.$3).getURI(),b=null;this.$2&&(b=h.getDataFt(this.$2));new i(a).setMethod("POST").setData({ft_data:b}).send()};e.exports=a}),null);
__d("VideoDownloadLogger",["Bootloader","CurrentUser","md5"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=null,k=null,l=2147483647,m="video_download";function n(){return Date.now()}function o(a){"use strict";a=a?a:{},this.$1=a}o.prototype.$2=function(a,b){"use strict";b=babelHelpers["extends"]({},b,this.$1);!a;Object.prototype.hasOwnProperty.call(b,"time_ms")||(b.time_ms=n());Object.prototype.hasOwnProperty.call(b,"connectivity_type")||(b.connectivity_type=k.getConnectivityType());b={logData:b,event:a};j.post(m,b)};o.prototype.logEvent=function(a,b){"use strict";!j||!k?g.loadModules(["Banzai","MVideoUtils"],function(c,d){j=c,k=d,this.$2(a,b)}.bind(this),"VideoDownloadLogger"):this.$2(a,b)};o.time=function(){"use strict";return Math.floor(Date.now()/1e3)};o.generateSessionID=function(){"use strict";return i([h.getID(),o.time(),Math.random()*l].join(":"))};e.exports=o}),null);
__d("VideoDownloadLoggerEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CONTROL_IMPRESSION:"control_impression",DOWNLOAD_CANCELLED:"download_cancelled",DOWNLOAD_DELETED:"download_deleted",DOWNLOAD_FAILED:"download_failed",DOWNLOAD_FINISHED:"download_finished",DOWNLOAD_PROGRESS:"download_progress",DOWNLOAD_REQUESTED:"download_requested",SLOW_PLAYBACK_DETECTED:"slow_playback_detected",SURVEY_URI_REQUESTED:"survey_uri_requested",SURVEY_IMPRESSION_ATTEMPT:"survey_impression_attempt",SURVEY_PROMPT_RESULT:"survey_prompt_result",QUALITY_SELECTED:"quality_selected",QUALITY_SELECTOR_IMPRESSION:"quality_selector_impression",QUALITY_SELECTOR_NO_QUALITIES_AVAILABLE:"quality_selector_no_qualities_available",REQUESTED_PLAYING:"requested_playing",PAGE_SETTING_CHANGE:"page_setting_change"})}),null);
__d("VideoDownloadLoggerFields",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({APP_ID:"app_id",AVAILABLE_QUALITIES:"available_qualities",AVAILABLE_QUALITIES_COUNT:"available_qualities_count",BYTES_DOWNLOADED:"bytes_downloaded",CONFIG_NAME:"config_name",CONNECTIVITY_TYPE:"connectivity_type",DELETE_REASON:"delete_reason",DEVICE_YEAR_CLASS:"device_year_class",DOWNLOAD_ORIGIN:"download_origin",DOWNLOAD_SETTING:"download_setting",ELAPSED_TIME_MS:"elapsed_time_ms",ERROR:"error",ERROR_CODE:"error_code",EVENT_NAME:"event_name",EVENT_ORIGIN:"event_origin",EVENT_SUBORIGIN:"event_suborigin",IS_EMPLOYEE:"is_employee",IS_VISIBLE:"is_visible",OWNER_ID:"owner_id",QUALITY:"quality",REASON:"reason",SAVED_OFFLINE:"saved_offline",SESSION_ID:"session_id",TOTAL_SIZE:"total_size",TIME_MS:"time_ms",VIDEO_ID:"video_id"})}),null);
__d("VideoDownloadReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({AUTO_INITIATED:"auto_initiated",USER_INITIATED:"user_initiated"})}),null);
__d("MVideoCache",["MLegacyDataStore","MVideoCacheConfig","MVideoDownloadConfig","URIDownloader","VideoDownloadDeleteReason","VideoDownloadEventHandler","VideoDownloadLogger","VideoDownloadLoggerEvent","VideoDownloadLoggerFields","VideoDownloadReason","emptyFunction","AsyncStorage","WebStorage"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){__p&&__p();var r=null,s=null,t={},u=500,v=4e9,w=0,x={audio:"audio",video:"video"};function y(a,b){"use strict";this.$1=a,this.$2=b,a.chunked?this.$3=b===x.video?a.videoChunkCount:a.audioChunkCount:this.$3=1,this.$4=0}y.prototype.getNextBuffer=function(a){"use strict";if(this.$4>=this.$3)a(null);else{var b=this.$4++;z.getCachedStream(this.$1,this.$2,function(b){a(b)},a,this.$1.chunked?b:null)}};var z={DEFAULT_QUALITY_TAG:"default",DOWNLOAD_STARTED_TIME:"downloadStartedTime",DOWNLOAD_REASON:"downloadReason",OFFLINE_LIFESPAN:"offlineLifespan",VIEW_COUNT:"viewCount",RESOURCE_STATE:{loading:"loading",finished:"finished",error:"error"},ERROR:{QUOTA_EXCEEDED:1,NO_ACCESS:2},isDownloadInProgress:function(){return!z.isEmptyObject(t)},isSupported:function(){try{r||(r=b("AsyncStorage"));s||(s=b("WebStorage"));return s.getLocalStorage()&&window.indexedDB&&navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota}catch(a){r=null;s=null;return!1}},downloadVideo:function(a,b,c,d,e,f,g,h,i){__p&&__p();g===void 0&&(g={});h===void 0&&(h=p.USER_INITIATED);i===void 0&&(i=null);var j=JSON.parse(b),k=z.createVideoResource(j,f),l=z.createAudioResource(j,f);if(!k&&!l){d();return}var m=[];k&&m.push(k);l&&m.push(l);m=z.calculateTotalSize(b,f);var q=z.createTracking(a,m,j.offline_lifespan_ms,c,d,e,f,g.origin,h,i);if(!q){d();return}b={};b[o.EVENT_ORIGIN]=g.origin;b[o.EVENT_SUBORIGIN]=g.suborigin;z.logEventTracking(q,n.DOWNLOAD_REQUESTED,b);z.flushAsyncStorage(function(){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(a,b){var c=z.getTotalSizeOfLoadingResources();if(a+q.totalSize+c<z.getMaxCacheUsage()&&q.totalSize+c+z.getMinFreeSpace()<b)z.downloadPostQuotaCheck(q,k,l);else{c="Used: "+a+" Remaining: "+b+" MaxCacheUsage: "+z.getMaxCacheUsage()+" MinFreeSpace: "+z.getMinFreeSpace();z.onError(q,z.ERROR.QUOTA_EXCEEDED,c)}},function(){z.onError(q,z.ERROR.QUOTA_EXCEEDED)})})},getDownloadNotificationUri:function(a){a=JSON.parse(a);return a&&a.download_finished_notification_uri},deleteVideoByID:function(a,b,c,d){__p&&__p();d===void 0&&(d={});b=b?b:q;var e=z.getTracking(a),f={};f[o.EVENT_ORIGIN]=d.origin;f[o.EVENT_SUBORIGIN]=d.suborigin;f[o.REASON]=c||k.USER_INITIATED;if(e)z.logEventTracking(e,n.DOWNLOAD_CANCELLED,f),z.deleteTracking(e,!0);else{z.logEvent(a,n.DOWNLOAD_DELETED,f);d=new l(a,null,n.DOWNLOAD_DELETED);d.sendServerDownloadEvent()}z.deleteCachedVideoFromStorage(a,b)},calculateTotalSize:function(a,b){a=JSON.parse(a);a=z.getStreamsForQuality(a,b);return a&&z.calculateTotalSizeInState(a,void 0)},getQualitiesFromResources:function(a){__p&&__p();a=JSON.parse(a);a=a&&a.streams;if(!a)return null;var b=null,c={};for(var d=0;d<a.length;d++){var e=a[d],f=String(e.mimetype);if(f&&f.startsWith(x.video)){var g=Object.prototype.hasOwnProperty.call(e,"quality")&&String(e.quality);g&&(c[g]=e.size)}else f&&f.startsWith(x.audio)&&(b=e)}if(b)for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&c[h]&&(c[h]+=b.size);return c},deleteVideosByID:function(a,b,c){if(z.isSupported())for(var d=0;d<a.length;d++){var e=a[d];z.deleteVideoByID(e,function(){b(e)},c)}},isVideoDownloaded:function(a){if(z.isSupported()){a=z.getCachedVideoByID(a);if(a)return!0;else return!1}return!1},isVideoDownloading:function(a){return z.isSupported()?t&&t[a]:!1},getVideoSize:function(a,b,c){__p&&__p();if(z.isSupported()){var d=z.getTracking(a);if(d)return d.totalSize;d=z.getCachedVideoByID(a);if(d)return d.totalSize;if(b){a=z.calculateTotalSize(b,c);if(a&&a>0)return a}}return null},getVideoProgressByID:function(a){if(z.isSupported()){a=z.getTracking(a);if(a)return a.loaded}return 0},_fillMissingFieldsWithDefaults:function(a,b){for(var c=0;c<b.length;c++){var d=b[c];d===z.DOWNLOAD_STARTED_TIME&&!Object.prototype.hasOwnProperty.call(a,d)&&(a.downloadStartedTime=0);d===z.DOWNLOAD_REASON&&!Object.prototype.hasOwnProperty.call(a,d)&&(a.downloadReason=p.USER_INITIATED);d===z.OFFLINE_LIFESPAN&&!Object.prototype.hasOwnProperty.call(a,d)&&(a.offlineLifespan=i.cache_default_offline_lifespan_ms)}return a},getCachedVideoByID:function(a){__p&&__p();if(!i.enabled&&!i.simulate_legacy_ux)return null;var b=z.createPrefix(a),c=null;try{c=s.getLocalStorage().getItem(b)}catch(a){}b=c&&JSON.parse(c);b=b&&z._fillMissingFieldsWithDefaults(b,[z.DOWNLOAD_STARTED_TIME,z.DOWNLOAD_REASON,z.OFFLINE_LIFESPAN]);if(i.simulate_legacy_ux)return null;if(b&&b.chunked&&!i.cache_chunked_playback_enabled){setTimeout(function(){z.deleteVideoByID(a,q,k.CHUNKED_PLAYBACK_NOT_SUPPORTED)},0);return null}return b},getCachedVideosMetadata:function(a,b){__p&&__p();a===void 0&&(a=[]);b===void 0&&(b=!1);var c={};if(!z.isSupported())return c;var d=s.getLocalStorage(),e=Object.keys(d),f=h.getUserPrefix();for(var g in e)if(Object.prototype.hasOwnProperty.call(e,g)&&e[g]&&e[g].startsWith(f)){var j=z.getVideoIDFromStorageKey(e[g]),k={};if(a.length>0){var l=null;try{l=d.getItem(e[g])}catch(a){if(!b)continue}l=l&&JSON.parse(l);if((!l||l.chunked&&!i.cache_chunked_playback_enabled)&&!b)continue;for(var m=0;m<a.length;m++){var n=a[m];l&&n in l&&(k[n]=l[n])}k=z._fillMissingFieldsWithDefaults(k,a)}c[j]=k}return c},getCachedVideoIDs:function(a){a===void 0&&(a=!1);return Object.keys(z.getCachedVideosMetadata([],a))},hasDownloadedVideos:function(){var a=z.getCachedVideoIDs();return a&&a.length&&a.length>0},getDownloadingVideos:function(){var a=Object.keys(t);return a},getVideoIDFromStorageKey:function(a){var b=h.PREFIX_SEPARATOR;return a.split(b)[2]||""},getCachedVideo:function(a){a=g.get(a);return z.getCachedVideoByID(a.videoID)},getCachedVideoStream:function(a,b,c){z.getCachedStream(a,x.video,b,c)},getCachedAudioStream:function(a,b,c){z.getCachedStream(a,x.audio,b,c)},getCachedVideoStreamObject:function(a){return new y(a,x.video)},getCachedAudioStreamObject:function(a){return new y(a,x.audio)},getMaxCacheUsage:function(){var a=v;i&&Object.prototype.hasOwnProperty.call(i,"max_cache_usage")&&(a=i.max_cache_usage);return a},getMinFreeSpace:function(){var a=w;i&&Object.prototype.hasOwnProperty.call(i,"min_free_space")&&(a=i.min_free_space);return a},downloadPostQuotaCheck:function(a,b,c){if(!z.addTracking(a)){z.onError(a);return}b&&z.sendResourceRequest(a,b);c&&z.sendResourceRequest(a,c)},calculateTotalSizeInState:function(a,b){var c,d=0,e=a.length;for(c=0;c<e;c++){var f=a[c];(!b||f.state===b)&&(d+=f.size)}return d},isEmptyObject:function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b)&&a[b])return!1;return!0},getTotalSizeOfLoadingResources:function(){var a=0;for(var b in t)if(Object.prototype.hasOwnProperty.call(t,b)&&t[b]){var c=t[b];a+=z.calculateTotalSizeInState(c.resources,z.RESOURCE_STATE.loading)}return a},deleteCachedVideoFromStorage:function(a,b){__p&&__p();a=z.createPrefix(a);try{s.getLocalStorage().removeItem(a)}catch(a){}z.getObjectKeysFromAsyncStorageByPrefix(a,function(a,c){if(a||!c){b();return}try{r.multiRemove(c,function(){b()})}catch(a){b()}})},flushAsyncStorage:function(a){__p&&__p();var b=z.createPrefix(0),c=["0"];c=new Blob(c,{type:"text/html"});try{r.setItem(b,c,function(){try{r.removeItem(b,function(){a()})}catch(b){a()}})}catch(c){try{r.removeItem(b,function(){a()})}catch(b){a()}}},getObjectKeysFromAsyncStorageByPrefix:function(a,b){__p&&__p();try{r.getAllKeys(function(c,d){if(c||!d){b(c);return}d=d.filter(function(b){return b.startsWith(a)});b(null,d)})}catch(a){b(a)}},getVideosFromAsyncStorage:function(a){__p&&__p();z.getObjectKeysFromAsyncStorageByPrefix(h.getUserPrefix(),function(b,c){if(b||!c){a(b);return}b=c.map(z.getVideoIDFromStorageKey);c=b.reduce(function(a,b){a[b]=!0;return a},{});a(null,Object.keys(c))})},makeLocalAsyncStorageConsistent:function(a,b){__p&&__p();var c=z.getCachedVideoIDs(!0);z.getVideosFromAsyncStorage(function(d,e){__p&&__p();if(d||!e){a();return}var f={};d=c.concat(e);d.forEach(function(a){!f[a]?f[a]=1:f[a]++});f=Object.keys(f).filter(function(a){return f[a]===1});f.length>0&&z.deleteVideosByID(f,b,k.CONSISTENCY_CHECK);a()})},getCachedStream:function(a,b,c,d,e){b=z.createPrefix(a.videoID,b,e);try{r.getItem(b,function(b,e){b?(z.deleteVideoByID(a.videoID),d()):c(e)})}catch(b){z.deleteVideoByID(a.videoID),d()}},saveVideoInLocalStorage:function(a){var b=a.videoID&&z.createPrefix(a.videoID);try{s.getLocalStorage().setItem(b,JSON.stringify(a))}catch(a){throw a}},saveCachedVideo:function(a){__p&&__p();var b={};b.downloadStartedTime=a.downloadStartedTime;b.downloadReason=a.downloadReason;b.videoID=a.videoID;b.quality=a.quality;b.audioCodec=z.getResourceCodec(a,x.audio);b.videoCodec=z.getResourceCodec(a,x.video);b.totalSize=a.totalSize;b.offlineLifespan=a.offlineLifespan;b.viewCount=0;b.sessionID=a.sessionID;b.downloadOrigin=a.origin;b.chunked=a.chunked;b.videoChunkCount=a.videoChunkCount;b.audioChunkCount=a.audioChunkCount;z.saveVideoInLocalStorage(b)},logPlaybackRequest:function(a,b,c){__p&&__p();var d=null;if(b){b=z.getCachedVideoByID(a);var e=b.viewCount||0;b.viewCount=e+1;z.saveVideoInLocalStorage(b)}else d=z.ERROR.NO_ACCESS;e={};e[o.ERROR_CODE]=d;e[o.REASON]=c;z.logEvent(a,n.REQUESTED_PLAYING,e)},createPrefix:function(a,b,c){a=h.getUserPrefix()+a+h.PREFIX_SEPARATOR+z.DEFAULT_QUALITY_TAG;b&&(a=a+h.PREFIX_SEPARATOR+b);c!=void 0&&c!=null&&(a=a+h.PREFIX_SEPARATOR+c);return a},createResource:function(a,b,c,d){var e={};e.src=a;e.type=b;e.state=z.RESOURCE_STATE.loading;e.codec=c;e.size=d;e.progress=0;return e},getDefaultVideoStream:function(a){__p&&__p();var b=null;for(var c=0;c<a.length;c++){var d=a[c],e=String(d.mimetype);if(e&&e.startsWith(x.video)){b=d;if(d["default"])return d}}return b},getStreamsForQuality:function(a,b){__p&&__p();var c=[];a=a&&a.streams;var d=!1,e=!1;for(var f=0;f<a.length;f++){var g=a[f],h=String(g.mimetype);if(h&&h.startsWith(x.video)&&!d){var i=String(g.quality);b&&i&&i===b&&(d=!!c.push(g))}else h&&h.startsWith(x.audio)&&!e&&(e=!!c.push(g))}if(!d){i=z.getDefaultVideoStream(a);i&&c.push(i)}return c},getUrlInfo:function(a,b,c){__p&&__p();a=z.getStreamsForQuality(a,c);if(!a)return null;c=null;for(var d=0;d<a.length;d++){var e=a[d],f=String(e.mimetype);if(f&&f.startsWith(b)){c=e;break}}return c},createVideoResource:function(a,b){a=z.getUrlInfo(a,x.video,b);return a&&z.createResource(a.url,x.video,a.codecs,a.size)},createAudioResource:function(a,b){a=z.getUrlInfo(a,x.audio,b);return a&&z.createResource(a.url,x.audio,a.codecs,a.size)},addTracking:function(a){if(t[a.videoID])return!1;t[a.videoID]=a;return!0},createTracking:function(a,b,c,d,e,f,g,h,j,k){__p&&__p();var l={};l.videoID=a;l.quality=g||z.DEFAULT_QUALITY_TAG;l.onDone=d;l.onError=e;l.onProgress=f;l.resources=[];l.deleted=!1;l.loaded=0;l.totalSize=b;l.offlineLifespan=c;l.sessionID=m.generateSessionID();l.origin=h;l.logger=z.createLogger(l);l.downloadStartedTime=Date.now();l.chunked=i.cache_chunked_storage_enabled;l.loggingDataCallback=k;l.downloadReason=j;return l},getTracking:function(a){return t[a]},deleteTracking:function(a,b){__p&&__p();var c={};c[o.REASON]=a.downloadReason;if(!a.deleted){a.deleted=!0;t[a.videoID]=null;if(b){for(b=0;b<a.resources.length;b++)try{a.resources[b].downloader&&a.resources[b].downloader.abort()}catch(b){z.logEventTracking(a,n.DOWNLOAD_FAILED,c)}}}},getResourceCodec:function(a,b){var c,d,e;e=a.resources.length;for(d=0;d<e;d++){c=a.resources[d];if(c.type===b)return c.codec}return null},updateTracking:function(a,b,c){__p&&__p();var d,e;if(a.deleted)return;c&&(b.state=c);b.state===z.RESOURCE_STATE.finished&&(b.type===x.video?a.videoChunkCount=b.chunkCount:b.type===x.audio&&(a.audioChunkCount=b.chunkCount));if(b.state===z.RESOURCE_STATE.loading)a.resources.push(b);else{c=z.RESOURCE_STATE.finished;b=a.resources.length;for(d=0;d<b;d++){e=a.resources[d];if(e.state===z.RESOURCE_STATE.loading){c=z.RESOURCE_STATE.loading;break}else e.state===z.RESOURCE_STATE.error&&(c=z.RESOURCE_STATE.error)}if(c===z.RESOURCE_STATE.error)z.deleteTracking(a),z.deleteCachedVideoFromStorage(a.videoID,function(){z.onError(a)});else if(c===z.RESOURCE_STATE.finished)try{z.saveCachedVideo(a),z.deleteTracking(a),z.onDone(a)}catch(b){z.deleteCachedVideoFromStorage(a.videoID,function(){z.onError(a)})}}},trackProgress:function(a){var b=0;for(var c in a.resources)Object.prototype.hasOwnProperty.call(a.resources,c)&&(b+=a.resources[c].progress);a.loaded=b;var d={};d[o.BYTES_DOWNLOADED]=a.loaded;z.logEventTracking(a,n.DOWNLOAD_PROGRESS,d);return b},sendResourceRequest:function(a,b){__p&&__p();var c=new j(b.src,b.size);a.chunked?c.setChunkedResponseHandler(function(c){__p&&__p();try{var d=[];for(var e=0;e<c.length;e++){var f=[],g=z.createPrefix(a.videoID,b.type,e);f.push(g);g=c[e];f.push(g);d.push(f)}r.multiSet(d,function(d){b.chunkCount=c.length,z.updateTracking(a,b,d?z.RESOURCE_STATE.error:z.RESOURCE_STATE.finished)})}catch(c){z.updateTracking(a,b,z.RESOURCE_STATE.error)}}):c.setResponseHandler(function(c){try{var d=z.createPrefix(a.videoID,b.type);r.setItem(d,c,function(c){z.updateTracking(a,b,c?z.RESOURCE_STATE.error:z.RESOURCE_STATE.finished)})}catch(c){z.updateTracking(a,b,z.RESOURCE_STATE.error)}});c.setErrorHandler(function(){z.updateTracking(a,b,z.RESOURCE_STATE.error)});c.setProgressHandler(function(c){c.total&&(b.progress=c.loaded,a.onProgress(z.trackProgress(a),a.totalSize))});c.setAbortHandler(function(){setTimeout(function(){z.updateTracking(a,b,z.RESOURCE_STATE.error)},u)});z.updateTracking(a,b);b.downloader=c;c.sendRequest()},createLogger:function(a){var b={};b[o.DOWNLOAD_ORIGIN]=a.origin;b[o.QUALITY]=a.quality;b[o.SESSION_ID]=a.sessionID;b[o.TOTAL_SIZE]=a.totalSize;b[o.VIDEO_ID]=a.videoID;return new m(b)},getLogger:function(a){return!a.logger?null:a.logger},logEvent:function(a,b,c){var d=new m();c=c||{};c[o.VIDEO_ID]=a;a=z.getCachedVideoByID(a);a&&(c[o.DOWNLOAD_ORIGIN]=a.downloadOrigin,c[o.SESSION_ID]=a.sessionID,c[o.TOTAL_SIZE]=a.totalSize,c[o.QUALITY]=c[o.QUALITY]?c[o.QUALITY]:a.quality,c[o.SAVED_OFFLINE]=1);d.logEvent(b,c)},logEventTracking:function(a,b,c){var d=this.getLogger(a);c=c||{};Object.prototype.hasOwnProperty.call(c,o.REASON)||(c[o.REASON]=a.downloadReason);if(a.loggingDataCallback){var e=a.loggingDataCallback;c=e(c)}c[o.ELAPSED_TIME_MS]=Date.now()-a.downloadStartedTime;d.logEvent(b,c)},onError:function(a,b,c){var d={};d[o.ERROR_CODE]=b;d[o.ERROR]=c;z.logEventTracking(a,n.DOWNLOAD_FAILED,d);a.onError(b)},onDone:function(a){z.logEventTracking(a,n.DOWNLOAD_FINISHED),a.onDone()}};e.exports=z}),null);
__d("MVideoDownloadState",[],(function(a,b,c,d,e,f){a={DOWNLOADING:"downloading",DOWNLOADED:"downloaded",DELETING:"deleting",NOTDOWNLOADED:"notdownloaded"};e.exports=a}),null);
__d("MVideoDownloadStateHandler",["MVideoCache","MVideoDownloadState"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=null;function j(){"use strict";this.$1={},this.$2={}}j.prototype.addListener=function(a,b){"use strict";this.$1[a]||(this.$1[a]=[]),this.$1[a].push(b)};j.removeListeners=function(a){"use strict";this.$3().$1[a]&&(this.$3().$1[a]=[])};j.prototype.setState=function(a,b){"use strict";a.forEach(function(a){this.$2[a]=b;if(!this.$1[a])return;a=this.$1[a];a.forEach(function(a){try{a.call(window,b)}catch(a){}})},this)};j.prototype.getState=function(a){"use strict";return this.$2[a]};j.$3=function(){"use strict";i||(i=new j());return i};j.listen=function(a,b){"use strict";this.$3().addListener(a,b),this.initializeState(a)};j.initializeState=function(a){"use strict";g.isVideoDownloaded(a)?j.downloaded([a]):g.isVideoDownloading(a)?j.downloading([a],g.getVideoProgressByID(a),g.getVideoSize(a)):j.deleted([a])};j.getState=function(a){"use strict";return this.$3().getState(a)};j.downloading=function(a,b,c){"use strict";this.$3().setState(a,{state:h.DOWNLOADING,loaded:b,total:c})};j.downloaded=function(a){"use strict";this.$3().setState(a,{state:h.DOWNLOADED})};j.cleanup=function(a){"use strict";this.$3().setState(a,{state:h.DELETING})};j.deleted=function(a,b){"use strict";this.$3().setState(a,{state:h.NOTDOWNLOADED,errorMessage:b})};e.exports=j}),null);
__d("XVideoCacheCleanUpController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video_cache_cleanup/",{video_ids:{type:"StringVector",required:!0}})}),null);
__d("MVideoCacheCleanUp",["MRequest","MVideoCache","MVideoCacheConfig","MVideoDownloadConfig","MVideoDownloadStateHandler","VideoDownloadDeleteReason","VideoDownloadReason","XVideoCacheCleanUpController","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){__p&&__p();var p=1e4,q=null,r={clean:function(){__p&&__p();r.deleteExpiredVideos();q=null;var a=h.getCachedVideoIDs(!0);if(a.length==0){r.setLastCleanUpDate();return}a=n.getURIBuilder().setStringVector("video_ids",a).getURI();a=new g(a);a.setMethod("POST");a.listen("done",function(a){a=a.payload||{};if(!a.error){r.setLastCleanUpDate();a=[].concat(a.offlineDisabled,a.unaccessible,a.unsaved);a.length>0&&r.deleteVideosByID(a)}});a.send()},deleteExpiredVideos:function(){var a=h.getCachedVideosMetadata([h.DOWNLOAD_STARTED_TIME,h.DOWNLOAD_REASON,h.OFFLINE_LIFESPAN]),b=[],c=Date.now(),d=c-j.cache_auto_downloaded_videos_caching_interval_ms;for(var e in a){var f=a[e];(f.downloadReason===m.AUTO_INITIATED&&f.downloadStartedTime<d||f.downloadStartedTime<c-f.offlineLifespan)&&b.push(e)}b.length>0&&r.deleteVideosByID(b)},deleteVideosByID:function(a){h.deleteVideosByID(a,function(a){k.deleted([a])},l.CACHE_SYNC)},requestCleanUp:function(){if(i.isSupported()&&h.isSupported()){var a=r.getLastCleanUpDate(),b=Date.now()-j.cache_sync_interval_ms;a=a<b;a&&!q&&(q=o(function(){h.makeLocalAsyncStorageConsistent(r.clean,function(a){k.deleted([a])})},p))}},getLastCleanUpDate:function(){if(i.isSupported())return i.getItemFromConfig(i.KEYS.lastCleanUp);else return 0},setLastCleanUpDate:function(){if(i.isSupported()){var a=Date.now();i.setItemFromConfig(i.KEYS.lastCleanUp,a)}},checkAccess:function(a){a=a.downloadStartedTime;var b=r.getLastCleanUpDate();a=Math.max(a,b);b=Date.now();r.requestCleanUp();a=a+j.allowed_offline_access_interval_ms;a=a>b;return a}};e.exports=r}),null);
__d("MVideoPlaybackState",[],(function(a,b,c,d,e,f){a={NORMAL_PLAYBACK:"normalplayback",SLOW_PLAYBACK:"slowplayback",NOT_STARTED_PLAYBACK:"notstartedplayback"};e.exports=a}),null);
__d("Network",["mixInEventEmitter"],(function(a,b,c,d,e,f,g){__p&&__p();var h=!0,i=a.navigator.connection,j={0:"unknown",1:"ethernet",2:"wifi",3:"2g",4:"3g"};function b(){return h}function c(a){if(a==h)return;h=a;l.emit(a?"online":"offline")}function d(){return i?i.bandwidth:h?Infinity:0}function f(){return i?i.metered:!1}function k(){var a=i?String(i.type):"0";return j[a]||a}var l={getBandwidth:d,getType:k,isMetered:f,isOnline:b,setOnline:c};g(l,{online:!0,offline:!0});l=l;a.addEventListener?(a.addEventListener("online",c.bind(null,!0)),a.addEventListener("offline",c.bind(null,!1))):a.attachEvent&&(a.attachEvent("online",c.bind(null,!0)),a.attachEvent("offline",c.bind(null,!1)));e.exports=l}),null);
__d("MVideoUtils",["Bootloader","CSS","DataAttributeUtils","DOM","MLegacyDataStore","Network","cx","getViewportDimensions","performance"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){__p&&__p();var p=.5,q=0,r=null,s=null,t=null,u={PLAY_SIGIL:"playInlineVideo",INSERTION_POINT_SIGIL:"inlineVideo",LOADING_CLASS:"_2nmc",SHOWN_CLASS:"_53mu",SHOWN_CLASS_WITH_DOWNLOAD:"_2qoq",PLAYER_CLASS:"_53mv",FULL_WIDTH_PLAYER_CLASS:"_2c9v",SHOW_PAUSE_CLASS:"_3gzh",SHOW_PLAYING_CLASS:"_7bzf",SPHERICAL_CLASS:"_4a1j",DEBUGGER_CLASS:"_4551",PLAYER_STATE:{playing:"playing",paused:"paused"},API_INSTANCE_KEY:"m_video_player_api_instance_ref",createVideoNode:function(){var a={autobuffer:"true","x-webkit-airplay":"allow",controlslist:"nodownload"};a=j.create("video",a);h.addClass(a,u.FULL_WIDTH_PLAYER_CLASS);h.addClass(a,u.PLAYER_CLASS);return a},getStoryNode:function(a){return a&&a.getNode("story-div")},_handleLoggingOnPlayWithBootload:function(a,b,c,d){__p&&__p();if(r.isLoggedIn()){d=this.getStoryNode(a)||d;if(d){a=i.getDataFt(d);if(a){d={ft:JSON.parse(a)};if(b){b=b.getLogger();b.setFTData(d)}c.fbid&&c.ownerID&&(a=s.parse(a,e.id),a.video_info={video_id:c.fbid,owner_id:c.ownerID},a=s.stringify(a));new t("/feedtracking/").setMethod("POST").setData({ft_data:a,clicked_uri:c.src,tn:c.trackingNodes}).send()}}}},handleLoggingOnPlay:function(a,b,c,d){g.loadModules(["CurrentUser","FBJSON","MRequest"],function(e,f,g){r=e,s=f,t=g,u._handleLoggingOnPlayWithBootload(a,b,c,d)},"MVideoUtils")},getHumanReadbleSize:function(a){var b=1e3,c=b*b;b=b*b*b;if(a>b)return this.formatNumber(a,b,2)+" GB";else return this.formatNumber(a,c,1)+" MB"},formatNumber:function(a,b,c){return Math.ceil(a/(b/Math.pow(10,c)))/Math.pow(10,c)},getDownloadProgressText:function(a,b){return u.getHumanReadbleSize(a)+" / "+u.getHumanReadbleSize(b)},getDownloadProgressPercentage:function(a,b){a=a/b*100;a=a.toFixed(1);return a.toString()},getConnectivityType:function(){var a=l.getType(),b=null;a=="wifi"||a=="WIFI"?b="WIFI":(a=="cellular"||a=="2g"||a=="3g"||a=="wwan")&&(b="MOBILE");return b},getNetworkBandwidth:function(){var a=null;"connection"in navigator&&("downlinkMax"in navigator.connection&&(a=navigator.connection.downlinkMax));var b=null;try{b=parseFloat(a)}catch(a){}return typeof b!=="number"||isNaN(a)?null:b},getAvailableQualitiesString:function(a){return a&&a.join(", ")},isVisible:function(a){var b=n().height,c=n().width;if(a.height===0)return!1;var d=a.y-q+(1-p)*a.height,e=a.y+p*a.height,f=a.x+(1-p)*a.width;a=a.x+p*a.width;return d<0||e>=b||f<0||a>=c?!1:!0},getVideoDataFromMVideo:function(a){return k.get(a)},calculateBandwidth:function(){__p&&__p();var a=0,b=1e3,c=125e3;return function(){__p&&__p();if(a===0)for(var d=o.getEntries(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;var h=g.responseEnd-g.responseStart;if(h>0){g=g.transferSize/h;h=g*(b/c);h>a&&(a=h)}}return a}}()};e.exports=u}),null);
__d("MVideoAutoplayPlayerBase",["EventEmitter"],(function(a,b,c,d,e,f,g){__p&&__p();var h;b=babelHelpers.inherits(a,g);h=b&&b.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.wasVisible=!1,b}a.prototype.isVisible=function(){"use strict";throw new Error("Should be overridden")};a.prototype.getDistanceToViewport=function(){"use strict";throw new Error("Should be overridden")};a.prototype.playWithoutUnmute=function(a){"use strict";throw new Error("Should be overridden")};a.prototype.prepareForPlay=function(){"use strict";throw new Error("Should be overridden")};a.prototype.pause=function(a){"use strict";throw new Error("Should be overridden")};a.prototype.isAutoplayable=function(){"use strict";throw new Error("Should be overridden")};a.prototype.getDOMPosition=function(){"use strict";throw new Error("Should be overridden")};a.prototype.isLooping=function(){"use strict";throw new Error("Should be overridden")};a.prototype.isState=function(a){"use strict";throw new Error("Should be overridden")};a.prototype.setLastActionReason=function(a){"use strict";throw new Error("Should be overridden")};e.exports=a}),null);
__d("MVideoPlayerApiEvents",[],(function(a,b,c,d,e,f){a=["volumeChange","stateChange","fullscreenChange","destroyed","prepare"];e.exports=a}),null);
__d("MaybeNativePromise",["Promise"],(function(a,b,c,d,e,f,g){"use strict";b=a.Promise||g;g.resolve();e.exports=b}),null);
__d("VideoAkamaiRequestHelper",["URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a){return a.toLowerCase().indexOf("akamai")!==-1}function h(a){var b=a.startByte;a=a.endByte;if(b!=void 0&&!(b===0&&a==void 0)){b="bytes="+b+"-"+(a==void 0?"":a);return{Range:b}}return null}function b(a){var b=new g(a);b=b.getQueryData();var c=b.startByte;b=b.endByte;return h({baseUrl:a,startByte:c,endByte:b})}e.exports={isAkamai:a,getRequestHeaders:h,getRequestHeadersFromUrl:b}}),null);
__d("MVideoDashPrefetchCache",["regeneratorRuntime","Promise","BanzaiODS","Deferred","MaybeNativePromise","MOzExperiments","Run","URI","VideoAkamaiRequestHelper","XHRRequest","getCrossOriginTransport"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){__p&&__p();var r={maxPrefetchVideosNum:0,consolidateFragmentedPrefetchRequest:!1,fixPrefetchCacheAbort:!0,disablePrefetchCache:!1,enableGlobalSchedulerForPrefetch:!1,prefetchPriority:1,switchPrefetchTaskToHighPriWhenPlayed:!1};function s(a,b,c){var d=a.errorCode;a={name:a.errorType,message:a.errorMsg,type:c,url:b,status:d};return a}function t(a){return a.audio.length+a.video.length+a.manifest.length}function u(a,b){i.bumpEntityKey("mtouch_video_playback","prefetch."+a,b)}function v(a){var b="aborted",c={status:0},d=new Error("Prefetch request aborted.");return Object.assign(d,{type:b,url:a,xhr:c})}function w(a){var b=a.getURI(),c=b.toString();if(o.isAkamai(c)){var d=o.getRequestHeadersFromUrl(c);c=b.removeQueryData(["bytestart","byteend"]);a.setURI(c);d&&Object.keys(d).forEach(function(b){a.setRequestHeader(b,d[b])})}return a}var x=null,y=new Map();function z(a){a=new n(a);a=a.getDomain();return a.endsWith("fbcdn.net")&&!a.startsWith("interncache")&&!a.endsWith("ak.fbcdn.net")}function A(a,b){b===void 0&&(b=!1);return b&&z(a)?q.withCredentials:q}function B(a){return z(a.url)}function C(a,b,c){return{response:a.slice(b.start+0,b.end+1),responseTime:c}}function D(a){__p&&__p();var b=new n(a);if(b.getDomain()){b=b.removeQueryData(["oh"]);b=b.removeQueryData("__gda__");var c=Object.keys(b.getQueryData());for(var d=0;d<c.length;d++){var e=c[d];e.startsWith("_nc")&&(b=b.removeQueryData(e))}return b.toString()}return a}function E(){"use strict";this.$2=new Map(),this.$1=new Map(),this.$3=[],this.$4=[],this.$5=0,this.$6=r.maxPrefetchVideosNum,this.$7=r.consolidateFragmentedPrefetchRequest}E.prototype.$9=function(a,b){__p&&__p();b===void 0&&(b=!1);var c=a,d=new p(c).setMethod("GET").setResponseType("arraybuffer").setTransportBuilder(A(c,b));w(d);var e=new k(function(b,f){d.setErrorHandler(function(a){this.$10(d),f(s(a,c,"preload"))}.bind(this)),d.setResponseHandler(function(a){d.response=a,this.$10(d),b(d)}.bind(this)),d.setAbortHandler(function(){if(r.fixPrefetchCacheAbort){this.$10(d);var b=v(a);f(b)}else f(e,new Error("Request promise aborted"))}.bind(this))}.bind(this));this.$11(a,e);this.$3.push(d);this.$8?this.$8.push(d):d.send();return e};E.prototype.genPrefetchMpdNow=function(a){"use strict";__p&&__p();return g.async(function(b){while(1)switch(b.prev=b.next){case 0:if(!this.has(a)){b.next=2;break}return b.abrupt("return",null);case 2:return b.abrupt("return",this.$9(a));case 3:case"end":return b.stop()}},null,this)};E.prototype.$12=function(a,b,c){__p&&__p();b===void 0&&(b=!1);c===void 0&&(c=null);var d=[];for(var e=0;e<a.length;e++){var f=E.createQueryStringURL(a[e]);this.has(f)||(d.push(this.$9(f,b).then(function(a){u("received",1);return a})),c!=null&&this.$2.set(f,c))}u("sent",d.length);return d};E.prototype.$13=function(a){"use strict";__p&&__p();var b=E.getConsolidatedURL(a);if(b==null)return this.$12(a);var c=new p(b).setMethod("GET").setResponseType("arraybuffer").setTransportBuilder(A(b));w(c);var d=Date.now(),e=[];for(var f=0;f<a.length;f++){var g=E.createQueryStringURL(a[f]),i=new j();this.has(g)||this.$11(g,i.getPromise());e.push(i)}c.setErrorHandler(function(d){this.$10(c);for(var a=0;a<e.length;a++)e[a].reject(s(d,b,"preload"))}.bind(this));c.setResponseHandler(function(f){var g=Date.now()-d;for(var b=0;b<a.length;b++){var h=e[b],i=a[b];h.resolve(C(f,i,g))}this.$10(c)}.bind(this));c.setAbortHandler(function(){for(var b=0;b<a.length;b++){var c=e[b];c.reject(new Error("Request aborted."))}});this.$3.push(c);c.send();u("consolidated.sent",1);u("sent",e.length);g=e.map(function(a){return a.getPromise().then(function(a){u("received",1);return a})});h.all(g).then(function(){return u("consolidated.received",1)});return g};E.prototype.$14=function(a){"use strict";__p&&__p();var b=a.useCredentials,c=a.connectionQualityLevel;this.$5++;var d=this.$7&&!b;r.enableGlobalSchedulerForPrefetch&&(this.$8=[]);var e=d?this.$13(a.video):this.$12(a.video,b,c);d=d?this.$13(a.audio):this.$12(a.audio,b,c);c=this.$12(a.manifest,b);var f=e.concat(d,c);if(this.$8){var g=this.$8||[];this.$8=null;var h=""+a.videoID;b={name:"prefetch task, "+h,run:function(){h&&y["delete"](h);g.forEach(function(a){return a.send()});return k.all(f).then(function(){})["catch"](function(){})},cancel:function(){}};b.run();k.all(f).then(function(){return this.$15()}.bind(this))["catch"](function(){return this.$15()}.bind(this))}else k.all(f).then(function(){return this.$15()}.bind(this))["catch"](function(){return this.$15()}.bind(this))};E.prototype.$11=function(a,b){"use strict";a=D(a),this.$1.values().next().done&&m.onLeave(function(){for(var a=0;a<this.$3.length;a++)this.$3[a].abort();this.$3=[];this.$4=[];this.$5=0;this.$1.clear()}.bind(this)),this.$1.set(a,b)};E.prototype.$10=function(a){"use strict";a=this.$3.indexOf(a);a>-1&&this.$3.splice(a,1)};E.prototype.$15=function(){"use strict";this.$5--;var a=this.$4.shift();a&&this.$14(a)};E.prototype.has=function(a){"use strict";a=D(a);return this.$1.has(a)};E.prototype.getConnectionQualityLevel=function(a){"use strict";return this.$2.get(a)};E.prototype.get=function(a){"use strict";a=D(a);var b=this.$1.get(a);b?u("cache.hit",1):u("cache.miss",1);l.mtouch_reuse_cache_values||this.$1["delete"](a);u("retrieve",1);return b};E.prototype.$16=function(a){"use strict";a=D(a);a=this.$1.get(a);return a};E.prototype.queueRequestBatch=function(a){"use strict";this.$6===0||this.$5<this.$6?this.$14(a):(u("queued",t(a)),this.$4.push(a))};E.getInstance=function(){"use strict";x===null&&(x=new E());return x};E.createQueryStringURL=function(a){"use strict";var b=a.url,c=a.start;a=a.end;c!==null&&c!==void 0&&a!==null&&a!==void 0&&(b=new n(b).addQueryData({bytestart:c,byteend:a}));return b.toString()};E.getConsolidatedURL=function(a){"use strict";__p&&__p();var b="",c=Infinity,d=0;for(var e=0;e<a.length;e++){var f=a[e],g=f.url,h=f.start;f=f.end;if(g==null||h==null||f==null)return null;if(b==="")b=g;else if(b!==g)return null;c=Math.min(c,h);d=Math.max(d,f)}return E.createQueryStringURL({url:b,start:c,end:d})};E.loadVideo=function(a,b,c){"use strict";b=!!b;if(r.disablePrefetchCache||l.disable_prefetch)return;var d=E.getInstance();a.manifest||(a.manifest=[]);d.queueRequestBatch({manifest:a.manifest.filter(B),video:a.video.filter(B),audio:a.audio.filter(B),videoID:a.videoID,useCredentials:b,connectionQualityLevel:c})};E.getCacheValue=function(a){"use strict";var b=E.getInstance().get(a),c=!1;a=a.match(/bytestart=(\d+)/);if(a){a=parseInt(a[1],10);a<5e3&&(c=!0)}c&&u("consume."+(b?"hit":"miss"),1);return b};E.getConnectionQualityLevel=function(a){"use strict";return E.getInstance().getConnectionQualityLevel(a)};E.hasCacheValue=function(a){"use strict";return E.getInstance().has(a)};E.getPrefetchTaskByID=function(a){"use strict";a=y.get(a)||null;return a};e.exports=E}),null);
__d("MVideoPrefetcher",["Promise","MVideoAutoplayConfig","Run"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=null,k=500;function l(){"use strict";this.$1=new Map(),this.$2=new Map(),this.$3=[],this.$4=[],this.$5=0,this.$6=1}l.prototype.$7=function(a,b,c){"use strict";c.lastProgressValue*1e3>h.autoplay_prefetch_duration_threshold_ms||c.video.duration&&c.lastProgressValue>.9*c.video.duration?(clearInterval(c.watchdog),this.$8(c),this.$2.set(c.url,!0),a()):(clearInterval(c.watchdog),this.$8(c),b(new Error("Insufficient data received for a video preload")))};l.prototype.$9=function(a){"use strict";__p&&__p();var b=document.createElement("video");b.setAttribute("src",a);b.setAttribute("preload","auto");var c={};c.video=b;c.lastProgressTime=Date.now();c.lastProgressValue=0;c.url=a;var d=new g(function(a,d){c.watchdog=setInterval(function(){var b=Date.now();b>c.lastProgressTime+h.autoplay_prefetch_waiting_time_ms&&this.$7(a,d,c)}.bind(this),k),b.addEventListener("progress",function(){var a=b.buffered&&b.buffered.end&&b.buffered.length>0?b.buffered.end(0):0;a>c.lastProgressValue&&(c.lastProgressValue=a,c.lastProgressTimestamp=Date.now())})}.bind(this));this.$10(a,d);this.$3.push(c);b.load();return d};l.prototype.$11=function(a){"use strict";var b=[];for(var c=0;c<a.length;c++){var d=l.createQueryStringURL(a[c]);this.$1.has(d)||b.push(this.$9(d))}return b};l.prototype.$12=function(a){"use strict";this.$5++;a=this.$11(a.video);g.all(a).then(function(){this.$13()}.bind(this))["catch"](function(){return this.$13()}.bind(this))};l.prototype.$10=function(a,b){"use strict";__p&&__p();var c=!!this.$1.values().next().done;c&&i.onLeave(function(){for(var a=0;a<this.$3.length;a++)this.$14(this.$3[a]);this.$3=[];this.$4=[];this.$5=0;this.$1.clear()}.bind(this));this.$1.set(a,b)};l.prototype.$14=function(a){"use strict";a=a.video;a.setAttribute("src","");a.load&&a.load()};l.prototype.$8=function(a){"use strict";this.$14(a);a=this.$3.indexOf(a);a>-1&&this.$3.splice(a,1)};l.prototype.$13=function(){"use strict";this.$5--;var a=this.$4.shift();a&&this.$12(a)};l.prototype.getAndDelete=function(a){"use strict";var b=this.$1.get(a);this.$1["delete"](a);return b};l.prototype.getPreloadCache=function(a){"use strict";return this.$2.get(a)};l.prototype.queueRequestBatch=function(a){"use strict";this.$6===0||this.$5<this.$6?this.$12(a):this.$4.push(a)};l.getInstance=function(){"use strict";j===null&&(j=new l());return j};l.createQueryStringURL=function(a){"use strict";return a.url};l.loadVideo=function(a){"use strict";var b=l.getInstance();b.queueRequestBatch({video:[{url:a}]})};l.isVideoPreloaded=function(a){"use strict";return!!l.getInstance().getPreloadCache(a)};e.exports=l}),null);
__d("MVideoPlayerController",["EventEmitter","MInlineVideo","MLegacyDataStore","MOzExperiments","MOzVideoPlayerApi","MVideoDashPrefetchCache","MVideoExperiments","MVideoPlayerApiBase","MVideoPrefetcher","Stratcom","destroyOnUnload","getElementPosition","shouldUseOzPlayer"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){__p&&__p();var t;n.MVideoPlayerApiBase;var u="MVideoPlayerController_instance",v=null,w=null;a=babelHelpers.inherits(x,g);t=a&&a.prototype;function x(a,b,c,d){"use strict";t.constructor.call(this),this.$MVideoPlayerController2=b.video_ids,this.$MVideoPlayerController3=a.video_element,this.$MVideoPlayerController1=a.root_element,this.$MVideoPlayerController6=c,this.$MVideoPlayerController7=d,!j.no_prefetch_for_ctp&&!j.no_quickstarter_for_ctp&&(this.prefetch(),this.prepareMVideoPlayerApi()),this.$MVideoPlayerController4="ready",this.$MVideoPlayerController8(this.$MVideoPlayerController3),this.$MVideoPlayerController5=null,x.$MVideoPlayerController9()}x.prototype.prepareMVideoPlayerApi=function(a){"use strict";k.prepare(this.$MVideoPlayerController3,this.$MVideoPlayerController6,a)};x.prototype.prefetch=function(){"use strict";if(m.do_not_prefetch_autoplay)return;if(!this.$MVideoPlayerController6)return;this.$MVideoPlayerController6.connection_quality_level?l.loadVideo(this.$MVideoPlayerController6.prefetch_data,this.$MVideoPlayerController6.use_credentials,this.$MVideoPlayerController6.connection_quality_level):l.loadVideo(this.$MVideoPlayerController6.prefetch_data,this.$MVideoPlayerController6.use_credentials)};x.prototype.isFullscreen=function(){"use strict";return!1};x.prototype.getVideoID=function(){"use strict";return this.$MVideoPlayerController2[0]};x.prototype.play=function(a){"use strict";this.emit("playRequested",a),this.sendPlayRequest(a)};x.prototype.prepareForPlay=function(){"use strict"};x.prototype.sendPlayRequest=function(a){"use strict";var b=!0;b=h.showPlayer(null,this.$MVideoPlayerController3,b,a);(!b||!m.mtouch_no_double_play)&&h.play(a)};x.prototype.pause=function(a){"use strict";this.emit("pauseRequested",a),h.pause(a)};x.prototype.isAutoplayable=function(){"use strict";return!1};x.prototype.getDOMPosition=function(){"use strict";return r(this.getRootNode())};x.prototype.setState=function(a){"use strict";this.$MVideoPlayerController4=a,this.emit("stateChange")};x.prototype.isState=function(a){"use strict";return this.$MVideoPlayerController4===a};x.prototype.getVideoNode=function(){"use strict";return this.$MVideoPlayerController3};x.prototype.getRootNode=function(){"use strict";return this.$MVideoPlayerController1};x.prototype.setLastActionReason=function(a){"use strict";this.$MVideoPlayerController5=a,a&&h.setLastActionReason(a)};x.prototype.getLastActionReason=function(){"use strict";return this.$MVideoPlayerController5};x.prototype.preload=function(){"use strict";if(m.do_not_prefetch_autoplay)return;var a=i.get(this.$MVideoPlayerController3),b=a&&a.src;b&&!s(a)&&o.loadVideo(b)};x.prototype.isPreloaded=function(){"use strict";var a=i.get(this.$MVideoPlayerController3);a=a&&a.src;return a&&o.isVideoPreloaded(a)};x.$MVideoPlayerController9=function(){"use strict";__p&&__p();if(v)return;v=[p.listen("m:video:player:play",null,function(a){a=x.$MVideoPlayerController10(a);x.handleApiBeginPlayback(a);!w&&m.refresh_browser_autoplay_settings&&(w=null)}),p.listen("m:video:player:pause",null,function(a){var b=x.$MVideoPlayerController10(a);a=!!(a.getData()&&a.getData().destroyed);x.handleApiPausePlayback(b,a)}),p.listen("m:video:player:ended",null,function(a){a=x.$MVideoPlayerController10(a);x.handleApiFinishPlayback(a)}),p.listen("m:video:player:volumechange",null,function(a){a=x.$MVideoPlayerController10(a);x.handleApiVolumeChange(a)}),p.listen("m:video:player:fullscreenchange",null,function(a){a=x.$MVideoPlayerController10(a);x.handleApiFullScreenChange(a)}),p.listen("m:video:player:prepare",null,function(a){a=x.$MVideoPlayerController10(a);x.handleApiPrepare(a)}),p.listen("m:video:player:destroy",null,function(a){a=x.$MVideoPlayerController10(a);x.handleApiDestroyed(a)})];q(function(){v&&(v.forEach(function(a){return a.remove()}),v=null)})};x.handleApiBeginPlayback=function(a){"use strict";a=i.get(a)[u];a&&a.$MVideoPlayerController11()};x.handleApiPausePlayback=function(a,b){"use strict";a=i.get(a)[u];a&&a.$MVideoPlayerController12(b)};x.handleApiFinishPlayback=function(a){"use strict";a=i.get(a)[u];a&&a.$MVideoPlayerController13()};x.handleApiVolumeChange=function(a){"use strict";a=i.get(a)[u];a&&a.$MVideoPlayerController14()};x.handleApiFullScreenChange=function(a){"use strict";a=i.get(a)[u];a&&a.$MVideoPlayerController15()};x.handleApiDestroyed=function(a){"use strict";a=i.get(a)[u];a&&a.$MVideoPlayerController16()};x.handleApiPrepare=function(a){"use strict";a=i.get(a)[u];a&&a.$MVideoPlayerController17()};x.prototype.$MVideoPlayerController11=function(){"use strict";this.setState("playing")};x.prototype.$MVideoPlayerController12=function(a){"use strict";!this.isState("finished")&&!this.isState("ready")&&(!a?this.setState("paused"):this.setState("ready"))};x.prototype.$MVideoPlayerController13=function(){"use strict";this.setState("finished")};x.prototype.$MVideoPlayerController14=function(){"use strict";this.emit("volumeChange")};x.prototype.$MVideoPlayerController15=function(){"use strict";this.emit("fullscreenChange")};x.prototype.$MVideoPlayerController16=function(){"use strict";this.setState("ready"),this.emit("destroyed")};x.prototype.$MVideoPlayerController17=function(){"use strict";this.emit("prepare")};x.prototype.$MVideoPlayerController8=function(a){"use strict";var b={};b[u]=this;i.set(a,b)};x.$MVideoPlayerController10=function(a){"use strict";a=a.getData();return a&&a.videoElement};x.isBrowserAutoplayEnabled=function(){"use strict";if(w===null){var a=document.createElement("video");a.muted=!0;a.play();w=!a.paused;a.pause()}return w};e.exports=x}),null);
__d("VideoAutoplayValues",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ON:"on",OFF:"off",DOWNLOADED_ONLY:"downloaded_only",WIFI_ONLY:"wifi_only",DEFAULT_AUTOPLAY:"default_autoplay"})}),null);
__d("MFeedVideoPlayerController",["KaiOSAutoplayModule","KaiOSLogger","MFullScreen","MOzExperiments","MVideoAutoplayConfig","MVideoAutoplayPlayerBase","MVideoCache","MVideoDownloadState","MVideoDownloadStateHandler","MVideoExperiments","MVideoPlayerApiEvents","MVideoPlayerController","MVideoUtils","VideoAutoplayValues","VideoPlayerReason","destroyOnUnload","getViewportDimensions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){__p&&__p();var x,y=.5;c=babelHelpers.inherits(b,l);x=c&&c.prototype;function b(a,b){"use strict";__p&&__p();x.constructor.call(this);this.$MFeedVideoPlayerController1=b;this.$MFeedVideoPlayerController2=a;this.$MFeedVideoPlayerController3=b.controller;this.$MFeedVideoPlayerController5=!1;this.$MFeedVideoPlayerController4=[];v(function(){this.$MFeedVideoPlayerController4.forEach(function(a){return a.remove()}),this.$MFeedVideoPlayerController4=[]}.bind(this));this.$MFeedVideoPlayerController6();if(j.no_prefetch_for_ctp||j.no_quickstarter_for_ctp){a=this.isAutoplayable();(!j.no_prefetch_for_ctp||j.no_prefetch_for_ctp&&a)&&this.$MFeedVideoPlayerController3.prefetch();this.$MFeedVideoPlayerController3.prepareMVideoPlayerApi(this)}this.$MFeedVideoPlayerController1.should_autoplay&&this.$MFeedVideoPlayerController7()}b.prototype.$MFeedVideoPlayerController7=function(){"use strict";r.isBrowserAutoplayEnabled()&&!m.isVideoDownloaded(this.getVideoID())&&this.$MFeedVideoPlayerController8()&&k.autoplay_prefetch_enabled&&(this.$MFeedVideoPlayerController3.preload&&this.$MFeedVideoPlayerController3.preload())};b.prototype.$MFeedVideoPlayerController8=function(){"use strict";__p&&__p();var a=this.$MFeedVideoPlayerController1.autoplay_setting;if(a===t.OFF)return!1;else if(m.isVideoDownloaded(this.getVideoID()))return!1;else if(a===t.WIFI_ONLY&&this.$MFeedVideoPlayerController9("WIFI"))return!0;else if(a===t.ON&&this.$MFeedVideoPlayerController9())return!0;return!1};b.prototype.$MFeedVideoPlayerController9=function(b){"use strict";__p&&__p();var c=s.getNetworkBandwidth();if(!c)if(p.desktop_no_bandwidthmax)return!0;else c=0;var d=s.getConnectivityType(),e=this.$MFeedVideoPlayerController1.autoplay_bandwidth_threshold_mbps!=null?this.$MFeedVideoPlayerController1.autoplay_bandwidth_threshold_mbps:k.autoplay_bandwidth_threshold_mbps;g.gkResult&&c===0&&(c=s.calculateBandwidth(),h.logAutoplay({bandwidth:c.toFixed(2),threshold:e.toFixed(2),detectedConnectivityType:a.navigator.connection?a.navigator.connection.type===void 0?"undefined":a.navigator.connection.type:"missing connection"}));d=(!b||d===b)&&c>=e;return d};b.prototype.isVisible=function(){"use strict";return this.$MFeedVideoPlayerController3.isFullscreen()||i.isFullScreen()?!0:s.isVisible(this.getDOMPosition())};b.prototype.getDistanceToViewport=function(){"use strict";if(this.$MFeedVideoPlayerController3.isFullscreen())return 0;var a=w().height,b=this.getDOMPosition();if(b.height===0)return-Infinity;b=b.y+(1-y)*b.height;return b-a/2};b.prototype.playWithoutUnmute=function(a){"use strict";this.$MFeedVideoPlayerController3.play(a)};b.prototype.prepareForPlay=function(){"use strict";!m.isVideoDownloaded(this.getVideoID())&&k.autoplay_prefetch_enabled&&k.autoplay_prepare_next_video_enabled&&this.$MFeedVideoPlayerController3.prepareForPlay()};b.prototype.pause=function(a){"use strict";this.$MFeedVideoPlayerController3.pause(a)};b.prototype.isAutoplayable=function(){"use strict";var a=!1,b=this.getVideoID();r.isBrowserAutoplayEnabled()&&!this.$MFeedVideoPlayerController5&&(this.$MFeedVideoPlayerController1.should_autoplay&&(m.isVideoDownloaded(b)?a=!1:this.$MFeedVideoPlayerController8()&&(k.autoplay_prefetch_required_for_playback?a=this.$MFeedVideoPlayerController3.isPreloaded():a=!0)));return a};b.prototype.getDOMPosition=function(){"use strict";return this.$MFeedVideoPlayerController3.getDOMPosition()};b.prototype.isLooping=function(){"use strict";return!1};b.prototype.getVideoID=function(){"use strict";return this.$MFeedVideoPlayerController3.getVideoID()};b.prototype.$MFeedVideoPlayerController6=function(){"use strict";var a=[["stateChange",function(a){return this.$MFeedVideoPlayerController10(a)}.bind(this)]],b=function(a){return this.emit.bind(this,a)}.bind(this);this.$MFeedVideoPlayerController4=a.map(function(a){return this.$MFeedVideoPlayerController3.addListener(a[0],a[1])}.bind(this)).concat(q.map(function(a){return this.$MFeedVideoPlayerController3.addListener(a,b(a))}.bind(this)));o.listen(this.getVideoID(),function(a){return this.$MFeedVideoPlayerController11(a)}.bind(this))};b.prototype.$MFeedVideoPlayerController10=function(){"use strict";this.$MFeedVideoPlayerController12()};b.prototype.$MFeedVideoPlayerController12=function(){"use strict";(!this.isState("playing")&&this.getLastActionReason()===u.USER||this.isState("finished"))&&(this.$MFeedVideoPlayerController5=!0,this.emit("autoplayableChange"))};b.prototype.$MFeedVideoPlayerController11=function(a){"use strict";a.state===n.DOWNLOADED&&(this.$MFeedVideoPlayerController5=!1,this.setLastActionReason(null),this.emit("autoplayableChange"))};b.prototype.isState=function(a){"use strict";return this.$MFeedVideoPlayerController3.isState(a)};b.prototype.getLastActionReason=function(){"use strict";return this.$MFeedVideoPlayerController3.getLastActionReason()};b.prototype.setLastActionReason=function(a){"use strict";this.$MFeedVideoPlayerController3.setLastActionReason(a),this.$MFeedVideoPlayerController12()};e.exports=b}),null);
__d("MVideoAutoplayControllerBase",["Stratcom","SubscriptionsHandler","VideoPlayerReason","Visibility","destroyOnUnload","throttle"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();function a(a){"use strict";this.$3=null,this.$2=null,this.$6=[],this.$1=a,this.$4=null,this.$5=new h(),k(function(){this.$6=[],this.$3=null,this.$4&&(this.$4.remove(),this.$4=null),this.$5.release()}.bind(this))}a.prototype.getVideoUnits=function(){"use strict";return this.$6};a.prototype.addVideoUnit=function(a){"use strict";this.$6.push(a)};a.prototype.getPlayingVideoUnit=function(){"use strict";return this.$3};a.prototype.setPlayingVideoUnit=function(a){"use strict";this.$3=a};a.prototype.playVideo=function(a,b){"use strict";this.setPlayingVideoUnit(a),this.$3&&this.$3.playWithoutUnmute(b)};a.prototype.addSubscriberVideoUnit=function(){"use strict";this.getVideoUnits().length||(this.$5.addSubscriptions(g.listen("resize",null,this.updateAutoplay.bind(this)),g.listen("blur",null,this.$8.bind(this)),g.listen("focus",null,this.$9.bind(this)),j.addListener(j.HIDDEN,this.$8.bind(this)),j.addListener(j.VISIBLE,this.$9.bind(this)),g.listen("MScrollArea:scrollend",null,l(this.updateAutoplay.bind(this),this.$1)),g.listen("MScrollArea:scroll",null,l(this.updateAutoplay.bind(this),this.$1)),g.listen("MScrollArea:create",null,l(this.updateAutoplay.bind(this),this.$1)),g.listen("MScrollArea:reflow",null,l(this.updateAutoplay.bind(this),this.$1))),this.$10()||this.$11())};a.prototype.$8=function(){"use strict";this.autoplayActive()&&!this.$2&&(this.$2=this.getPlayingVideoUnit(),this.pausePlayingVideo(i.PAGE_VISIBILITY))};a.prototype.$9=function(){"use strict";this.autoplayActive()&&this.$2&&(this.playVideo(this.$2,i.PAGE_VISIBILITY),this.$2=null)};a.prototype.$11=function(){"use strict";this.$4&&(this.$4.remove(),this.$4=null),this.$7=l(this.updateAutoplay.bind(this),this.$1),this.$4=g.listen("scroll",null,this.$12.bind(this))};a.prototype.$12=function(){"use strict";this.$7()};a.prototype.$10=function(){"use strict";return!!this.$4};a.prototype.getClosestVideoUnits=function(a,b){"use strict";return this.$6.filter(function(a){return a.getDistanceToViewport()>=0&&(!b||b&&a.isAutoplayable())}).sort(function(a,b){return a.getDistanceToViewport()-b.getDistanceToViewport()}).slice(0,a)};a.prototype.getVisibleUnits=function(){"use strict";var a=[];this.$6.forEach(function(b){b.isVisible()?(a.push(b),b.wasVisible||(b.wasVisible=!0)):b.wasVisible=!1});return a};a.prototype.pausePlayingVideo=function(a){"use strict";var b=this.$3;b&&(b.pause(a),this.$3=null)};a.prototype.updateAutoplay=function(){"use strict";throw new Error("Should be overridden")};a.prototype.autoplayActive=function(){"use strict";throw new Error("Should be overridden")};e.exports=a}),null);
__d("MVideoAutoplayControllerX",["MVideoAutoplayControllerBase","SubscriptionsHandler","VideoPlayerReason","destroyOnUnload","getViewportDimensions","setImmediate"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m,n=null,o=500;a=babelHelpers.inherits(p,g);m=a&&a.prototype;function p(){"use strict";m.constructor.call(this,o),this.$MVideoAutoplayControllerX1=!0,this.$MVideoAutoplayControllerX2=new h(),this.$MVideoAutoplayControllerX3=null,j(function(){this.$MVideoAutoplayControllerX4(),this===n&&(n=null)}.bind(this))}p.registerVideoUnit=function(a){"use strict";n==null&&(n=new p()),n.addSubscriberVideoUnit(),n.addVideoUnit(a),n.$MVideoAutoplayControllerX5(a),a.isVisible()&&n.updateAutoplay()};p.setShouldAutoplay=function(a){"use strict";n==null&&(n=new p()),n.$MVideoAutoplayControllerX1=a,n.updateAutoplay()};p.prototype.$MVideoAutoplayControllerX4=function(){"use strict";this.$MVideoAutoplayControllerX2.release()};p.prototype.$MVideoAutoplayControllerX6=function(a){"use strict";a&&(a.setLastActionReason(i.USER),this.getPlayingVideoUnit()&&this.setPlayingVideoUnit(null)),this.$MVideoAutoplayControllerX3=a,this.updateAutoplay()};p.prototype.$MVideoAutoplayControllerX5=function(a){"use strict";__p&&__p();if(!a.addListener)return;var b=function(){this.getPlayingVideoUnit()==a&&a.isState("paused")||this.getPlayingVideoUnit()!=a&&a.isState("playing")?this.$MVideoAutoplayControllerX6(a):a==this.$MVideoAutoplayControllerX3&&a.isState("finished")&&this.$MVideoAutoplayControllerX6(null)}.bind(this),c=function(){(a.isState("playing")||a.isState("paused"))&&this.$MVideoAutoplayControllerX6(a)}.bind(this),d=function(){this.getPlayingVideoUnit()!=a&&this.$MVideoAutoplayControllerX6(a)}.bind(this),e=function(){this.updateAutoplay()}.bind(this),f=function(){this.$MVideoAutoplayControllerX3&&this.$MVideoAutoplayControllerX3==a&&this.$MVideoAutoplayControllerX6(null)}.bind(this);this.$MVideoAutoplayControllerX2.addSubscriptions(this.$MVideoAutoplayControllerX7(a,"stateChange",b),this.$MVideoAutoplayControllerX7(a,"prepare",d),this.$MVideoAutoplayControllerX7(a,"volumeChange",c),this.$MVideoAutoplayControllerX7(a,"fullscreenChange",c),this.$MVideoAutoplayControllerX7(a,"autoplayableChange",e),this.$MVideoAutoplayControllerX7(a,"destroyed",f))};p.prototype.$MVideoAutoplayControllerX7=function(a,b,c){"use strict";a=a.addListener(b,function(){l(function(){c()})});return a};p.prototype.autoplayActive=function(){"use strict";this.$MVideoAutoplayControllerX3&&!this.$MVideoAutoplayControllerX3.isVisible()&&!this.$MVideoAutoplayControllerX3.isState("playing")&&(this.$MVideoAutoplayControllerX3=null);return this.$MVideoAutoplayControllerX3==null};p.prototype.updateAutoplay=function(){"use strict";__p&&__p();if(!this.autoplayActive())return;if(!this.$MVideoAutoplayControllerX1){this.pausePlayingVideo(i.AUTOPLAY);return}var a=this.getVisibleUnits(),b=a.length,c=null;if(b==1)c=a[0],c=c.isAutoplayable()?c:null;else if(b>1){var d=k().height/2;a.forEach(function(a){if(!a.isAutoplayable())return;var b=a.getDOMPosition();b=b.y+b.height/2;b=Math.abs(b-d);a.playPriority=b;(!c||typeof c.playPriority==="number"&&a.playPriority<c.playPriority)&&(c=a)})}this.getPlayingVideoUnit()?c!=this.getPlayingVideoUnit()&&(this.pausePlayingVideo(i.AUTOPLAY),this.playVideo(c,i.AUTOPLAY)):c&&this.playVideo(c,i.AUTOPLAY);b=this.getClosestVideoUnits(2,!0);a=b.length;var e=null;for(var f=0;f<a;f++)if(b[f]!==c){e=b[f];break}e&&e.prepareForPlay()};e.exports=p}),null);
__d("MVideoFeedRegister",["MFeedVideoPlayerController","MVideoAutoplayControllerX"],(function(a,b,c,d,e,f,g,h){a={registerVideoUnit:function(a,b){a=new g(a,b);h.registerVideoUnit(a)}};e.exports=a}),null);